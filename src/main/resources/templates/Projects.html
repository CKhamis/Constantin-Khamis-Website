<!DOCTYPE html>
<html xml:th="https://www.thymeleaf.org">
<head th:replace="Components :: head('Home')"></head>
<body class="bg-1 text-1">
<div th:replace="Components :: main-navigation"></div>
<style>
    #project-banner{
        background-image: url("images/Project Banner.svg");
        background-position: center center;
        background-size: cover;
        background-repeat: no-repeat;
    }
    #project-banner > div{
        background-image: linear-gradient(to right, transparent, #ea9431, transparent);
        background-size: 100% 3px;
        background-position: bottom;
        background-repeat: no-repeat;
    }
</style>
<div class="container-fluid mb-3" id="project-banner">
<div class="container-fluid p-5">
    <h1 class="text-center fw-bold p-5" style="font-size: 4rem">Project History</h1>
</div>
</div>
<main class="container-fluid">
    <noscript>
        <h2 class="text-center">JavaScript is required to view this page</h2>
    </noscript>
    <div class="container mb-3">
        <p class="fs-4">Welcome to the Projects page of this website. Here, you'll discover my projects organized into distinct "eras." Each era groups together projects that share common themes and intentions. These eras include the Interdimensional era, Pseudo-Industrial era, High School era, and Childhood era. Beyond high school, the era names become more abstract, adding an extra layer of intrigue to the categorization.</p>
    </div>
    <div id="main-content" class="px-2"></div>
</main>
<div th:replace="Components :: JS"></div>
<script>
    //fetch functions
    fetch("https://costionline.com/api/Projects/all")
        .then(checkStatus)
        .then(response => response.json())
        .then(data => {
            // Process the retrieved data
            displayProjects(data)
        })
        .catch(error => {
            // error handlingss="cont
            container.append($("<h3 class=\"text-center\">There was an error receiving data from Costi Online Services</h3><p class=\"text-center\">Please check the console for further information</p>"));
            console.error('Error retrieving data:', error);
        });

    //Render
    function displayProjects(data) {
        let currentEra = '';
        let insertHTML = '';

        data.forEach(project => {
            const links = project.repositoryLinks.map((link, index) => `<a href="${link}" class="btn btn-primary mb-3" style="margin-right:10px;">Repository ${index + 1}</a>`).join('');
            let badge = '';
            if (!project.discontinued) {
                badge = `<span class="badge rounded-pill bg-success">Active</span>`;
            }

            let cardContent = `
            <div class="my-2 col-12 col-md-6 col-lg-4 px-2">
                <div class="card border-box ${project.type} " id="${project.id}">
                    <img src="https://costionline.com${project.imagePath}" class="card-img-top" alt="${project.title}" style="aspect-ratio: 16 / 9; object-fit: cover">
                    <div class="card-body mx-md-1 mx-2">
                        <h5 class="card-title fw-bold fs-4">${project.title} ${badge}</h5>
                        <p class="text-secondary">${project.subtitle}</p>
                        <p class="card-text fs-5">${project.description}</p>
                        ${links}
                    </div>
                </div>
            </div>
        `;

            if (currentEra !== project.era) {
                if (currentEra !== '') {
                    // Close the previous era section if not the first one
                    insertHTML += '</div>';
                }
                // Start a new era section
                insertHTML += `
                <div class="row">
                    <h3 id="${project.era}" class="fs-3 text-center fw-bold col-12">${project.era.toUpperCase()} ERA</h3>
            `;
                currentEra = project.era;
            }

            insertHTML += cardContent;
        });

        // Close the last era section if there are any
        if (currentEra !== '') {
            insertHTML += '</div>';
        }
        // Insert the HTML into the container
        document.querySelector("#main-content").innerHTML = insertHTML;
    }

</script>
</body>
</html>